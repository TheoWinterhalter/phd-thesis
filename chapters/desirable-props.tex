% \setchapterpreamble[u]{\margintoc}
\chapter{Desirable properties of type theories}
\labch{desirable-props}

To compare different type theories there are several measures we can use in
form of usual or desirable properties that they migh satisfy or not.
After a brief presentation of the main ones I will summarise which of the
theories of \vrefch{flavours} has which properties in a table.

\section{Properties}

\subsection{Weakening and substitutivity}

Variables and binders are essential to type theory and as such we have to treat
them with care, in particular we want our theories to be \emph{compositional}
meaning that different blocks that make sense can be assembled into something
that still makes sense.
This is embodied in the two following properties.

\begin{definition}[Weakening]
  A type theory enjoys weakening when for any \(\Ga, \Xi \vdash t : A\) and
  \(\vdash \Ga, \Delta\) we have \(\Ga, \Delta, \Xi \vdash t : A\).
\end{definition}
\marginnote[-1.2cm]{
  Note that in more generality you might have to rename variables when
  weakening, so for this we usually introduce a \emph{lifting} operator
  \(\lift{}{}\) such that we have
  \(\Ga, \Delta, \Xi \vdash \lift{n}{k}\ t : \lift{n}{k}\ A\)
  where \(n = |\Delta|\) and \(k = |\Xi|\).
}

Weakening means that you can plug a term into a larger context.

Susbstitutions are the way to instantiate the variables that are bound.
This happens for instance after a \(\beta\)-reduction.
\reminder[-0.9cm]{\(\beta\)-reduction}{
  \[
    (\lambda (x:A). t)\ u \red_\beta t[x \sto u]
  \]
}
Substitutions are typed using two contexts: \(\sigma : \Ga \to \D\) basically
states that \(\sigma\) maps variables of \(\D\) to terms typed in \(\Ga\).
\begin{mathpar}
  \infer
    {\forall (x : A) \in \D,\ \Ga \vdash \sigma(x) : A\sigma}
    {\sigma : \Ga \to \D}
\end{mathpar}
This is sometimes written \(\Ga \vdash \sigma : \D\) instead, and typing
definitons vary a little depending on the definition of substitution but this
is the basic idea.

\begin{definition}[Substitutivity]
  A type theory is substitutive when for any \(\D \vdash t : A\)
  and any substitution \(\sigma : \Ga \to \D\), we have
  \(\Ga \vdash t\sigma : A\sigma\).
\end{definition}

More often than not, weakening and substitutivity also hold for reduction and
conversion.

\subsection{Inversion of typing}
\todo{Not really a measure, it always makes sense in some way}
\todo{Merge with weak/subst?}

\subsection{Validity}

\subsection{Unique / principal typing}

\subsection{Properties of reduction}
\todo{Confluence, termination}

\subsection{Canonicity}
\todo{With reduction or weaker with conversion (for ETT)}

\subsection{Decidability of type checking}

\subsection{Consistency}

\section{Summarising table}

\todo{Fill}
\begin{table*}
  \rowcolors{1}{SkyBlue!10!White}{}
  \caption[Properties of type theories]{Properties of type theories.}
  \begin{tabular}{l|c|c|c|c|c|c|c|c|c|}
    \cline{2-10}
    & \acrshort{WTT} & \acrshort{ITT} & \acrshort{ETT} & \acrshort{MLTT}
    & \acrshort{PCUIC} & ?HoTT & ?CubicalTT & ?2TT & ?HTS \\
    \hline
    \multicolumn{1}{ |c|  }{Weakening / substitutivity} &
    \multicolumn{9}{c|}{Yes} \\
    \hline
    \multicolumn{1}{ |c|  }{Inversion of typing} &
    \multicolumn{9}{c|}{Yes} \\
    \hline
    \multicolumn{1}{ |c|  }{Unique (U) / Principal type (P)} &
    U & U/P & No? & U & P & ? & ? & ? & ? \\
    \hline
  \end{tabular}
\end{table*}